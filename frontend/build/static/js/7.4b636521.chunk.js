(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[7],{38:function(e,t,n){"use strict";n(0),n(39);var r=n(1);t.a=function(e){var t=e.message,n=e.open;return Object(r.jsxs)("div",{className:n?"snackbar on":"snackbar",children:[Object(r.jsx)("span",{className:"snack_message",children:t}),Object(r.jsx)("button",{className:"btn_close_snack",onClick:function(){var e=document.querySelector(".snackbar");null===e||void 0===e||e.classList.remove("on")},children:"Close"})]})}},39:function(e,t,n){},52:function(e,t,n){"use strict";n(0),n(53);var r=n(1);t.a=function(e){var t=e.progress,n=e.progressRef;return Object(r.jsx)("div",{className:"progress_container",ref:n,children:Object(r.jsxs)("div",{className:"progress_bar_container",children:[Object(r.jsx)("h1",{className:"progress_title",children:"Uploading"}),Object(r.jsx)("div",{className:"bar",children:Object(r.jsx)("div",{className:"progress",style:{width:"".concat(t,"%")}})})]})})}},53:function(e,t,n){},88:function(e,t,n){},91:function(e,t,n){"use strict";n.r(t);var r,a,o=n(40),c=n(32),s=n.n(c),i=n(33),l=n(31),u=n(42),d=n(47),v=n(0),p=n(41),f=n(1),m=function(e){var t,n,r=e.register,a=Object(v.useState)(""),c=Object(l.a)(a,2),s=c[0],i=c[1],u=Object(v.useRef)(null),d=Object(v.useRef)(null);return Object(v.useEffect)((function(){var e,t=function(e){e.preventDefault(),e.stopPropagation()},n=function(){var e;null===(e=u.current)||void 0===e||e.classList.add("on")},r=function(){var e;null===(e=u.current)||void 0===e||e.classList.remove("on")},a=function(e){var t,n=document.querySelector(".inputFile"),r=null===(t=e.dataTransfer)||void 0===t?void 0:t.files[0],a=new DataTransfer;if(r&&n){var o=new FileReader;o.onload=function(){i(o.result)},o.readAsDataURL(r),a.items.add(r),n.files=a.files}};return["dragenter","dragover","dragleave","drop"].forEach((function(e){var n;null===(n=u.current)||void 0===n||n.addEventListener(e,t)})),["dragenter","dragover"].forEach((function(e){var t;null===(t=u.current)||void 0===t||t.addEventListener(e,n)})),["dragleave","drop"].forEach((function(e){var t;null===(t=u.current)||void 0===t||t.addEventListener(e,r)})),null===(e=u.current)||void 0===e||e.addEventListener("drop",a),function(){var e;["dragenter","dragover","dragleave","drop"].forEach((function(e){var n;null===(n=u.current)||void 0===n||n.removeEventListener(e,t)})),["dragenter","dragover"].forEach((function(e){var t;null===(t=u.current)||void 0===t||t.removeEventListener(e,n)})),["dragleave","drop"].forEach((function(e){var t;null===(t=u.current)||void 0===t||t.removeEventListener(e,r)})),null===(e=u.current)||void 0===e||e.removeEventListener("drop",a)}}),[]),Object(f.jsxs)(v.Fragment,{children:[Object(f.jsx)("div",{className:"dropzone",onClick:function(){var e;return null===(e=document.querySelector(".inputFile"))||void 0===e?void 0:e.click()},ref:u,style:{minHeight:(null===(t=d.current)||void 0===t?void 0:t.value)?"fit-content":"300px"},children:(null===(n=document.querySelector(".inputFile"))||void 0===n?void 0:n.value)?Object(f.jsx)("img",{src:null===s||void 0===s?void 0:s.toString(),alt:""}):Object(f.jsxs)("div",{className:"body-dropzone",children:[Object(f.jsx)(p.a,{}),Object(f.jsx)("p",{className:"text-dropzone",children:"Drop here your photo"})]})}),Object(f.jsx)("input",Object(o.a)(Object(o.a)({},r("image",{required:{value:!0,message:"Please enter your image"}})),{},{type:"file",className:"inputFile",onInput:function(e){var t,n=null===(t=e.target.files)||void 0===t?void 0:t[0];if(n){var r=new FileReader;r.onload=function(){i(r.result)},r.readAsDataURL(n)}}}))]})},j=n(65),g=n(36),b=n.n(g),h=(n(88),n(34)),O=["title","titleId"];function x(){return(x=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function y(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function w(e,t){var n=e.title,o=e.titleId,c=y(e,O);return v.createElement("svg",x({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",ref:t,"aria-labelledby":o},c),n?v.createElement("title",{id:o},n):null,r||(r=v.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"})),a||(a=v.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"})))}var N,E,k=v.forwardRef(w),L=(n.p,function(e){var t=e.register,n=e.setTags,r=e.tags,a=Object(v.useState)([]),c=Object(l.a)(a,2),u=c[0],d=c[1],p=document.querySelector(".autocomplete-container"),m=Object(v.useRef)(null),g=function(e){var t;(null===(t=document.querySelector(".input-tags-container"))||void 0===t?void 0:t.contains(null===e||void 0===e?void 0:e.target))||null===p||void 0===p||p.classList.remove("on")},O=function(){var e=Object(i.a)(s.a.mark((function e(){var t,n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem("t1ks1ehn"),e.next=3,b.a.get("".concat(h.a.api_uri,"/user/tags"),{headers:{Authorization:"Bearer ".concat(t)}});case 3:return n=e.sent,r=n.data,N=r.options,d(r.options),e.abrupt("return",r.options);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(v.useEffect)((function(){O()}),[]),Object(f.jsxs)("div",{className:"input-tags-container",children:[r.map((function(e){return Object(f.jsxs)("span",{children:[e.name," ",Object(f.jsx)(k,{onClick:function(){return function(e){var t=r.filter((function(t){return t.name!==e.name}));n(t)}(e)}})]},e.id)})),Object(f.jsx)("input",Object(o.a)(Object(o.a)({},t("tags",{validate:{noVoid:function(){return r.length>0||"Enter at least 1 tag"}}})),{},{ref:m,type:"text",onChange:function(e){null===p||void 0===p||p.classList.add("on"),document.addEventListener("click",g,{once:!0});var t=e.target.value,a=document.querySelector(".inputTags"),o=Date.now();null===a||void 0===a||a.addEventListener("keydown",(function(e){"Enter"===e.key&&(n([].concat(Object(j.a)(r),[{name:t,id:o}])),a.value="",null===p||void 0===p||p.classList.remove("on"))}),{once:!0});var c=N.filter((function(e){return-1!==e.name.toLowerCase().indexOf(t.toLowerCase())}));if(0===c.length)return d([{name:t,id:o}]),void o++;d(c)},placeholder:"Tags",className:"inputTags",autoComplete:"off",name:"tags"})),Object(f.jsx)("div",{className:"autocomplete-container",children:null===u||void 0===u?void 0:u.slice(0,5).map((function(e){return Object(f.jsx)("p",{className:"option",onClick:function(){return function(e){var t=document.querySelector(".autocomplete-container"),a=document.querySelector(".inputTags");if(r.find((function(t){return t.name===e.name})))return null===t||void 0===t?void 0:t.classList.remove("on");n([].concat(Object(j.a)(r),[e])),null===t||void 0===t||t.classList.remove("on"),a&&(a.value="")}(e)},children:e.name},e.id)}))})]})}),_=n(52),S=function(){var e=Object(v.useState)(0),t=Object(l.a)(e,2),n=t[0],r=t[1],a=localStorage.getItem("t1ks1ehn"),o=Object(v.useRef)(null),c=function(e){var t=100*e.loaded/e.total;r(t)};return{uploadNewPhoto:function(){var e=Object(i.a)(s.a.mark((function e(t,n){var i,l,u,d,v,p;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(i=o.current)||void 0===i||i.classList.add("on"),r(0),l=new FormData,e.prev=3,e.next=6,b.a.get("".concat(h.a.api_uri,"/photos/signature"),{headers:{Authorization:"Bearer ".concat(a)}});case 6:return d=e.sent,l.append("file",n),l.append("signature",d.data.signature),l.append("api_key",d.data.api_key),l.append("timestamp",d.data.timestamp),e.next=13,b.a.post("https://api.cloudinary.com/v1_1/dder8kjda/image/upload",l,{onUploadProgress:c});case 13:return v=e.sent,p={description:t.description,name:t.name,tags:t.tags,width:v.data.width,height:v.data.height,image:{secure_url:v.data.secure_url,public_id:v.data.public_id}},e.next=17,b.a.post("".concat(h.a.api_uri,"/photos/upload-photo/"),p,{headers:{Authorization:"Bearer ".concat(a)}});case 17:null===(u=o.current)||void 0===u||u.classList.remove("on"),e.next=23;break;case 20:throw e.prev=20,e.t0=e.catch(3),Error("Something went wrong");case 23:case"end":return e.stop()}}),e,null,[[3,20]])})));return function(t,n){return e.apply(this,arguments)}}(),progress:n,progressRef:o}},P=n(38),q=n(44);t.default=function(){var e,t,n,r,a=Object(u.a)().user,c=Object(v.useState)([]),p=Object(l.a)(c,2),j=p[0],g=p[1],b=Object(v.useState)(!1),h=Object(l.a)(b,2),O=h[0],x=h[1],y=Object(d.a)(),w=y.handleSubmit,N=y.formState.errors,k=y.register,R=y.reset,T=S(),C=T.progress,z=T.uploadNewPhoto,F=T.progressRef,D=function(){var e=Object(i.a)(s.a.mark((function e(t){var n,r,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(!1),a=null===(n=document.querySelector(".inputFile"))||void 0===n||null===(r=n.files)||void 0===r?void 0:r[0],E?clearTimeout(E):clearTimeout(),t.tags=j,e.next=6,z(t,a);case 6:R({image:(new DataTransfer).files}),g([]),x(!0),E=setTimeout((function(){x(!1)}),3e3);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(v.useEffect)((function(){return function(){clearTimeout(E)}}),[]),Object(f.jsxs)("div",{className:"upload_photo_page fadeIn",children:[Object(f.jsx)(q.a,{user:a}),Object(f.jsxs)("div",{className:"container",children:[Object(f.jsx)("h1",{className:"title_page",children:"Upload Photo"}),Object(f.jsxs)("div",{className:"dropzone-container",children:[Object(f.jsx)(m,{register:k}),Object(f.jsx)("div",{className:"message_error",children:null===(e=N.image)||void 0===e?void 0:e.message})]}),Object(f.jsxs)("form",{className:"form",children:[Object(f.jsxs)("div",{className:"controller_container",children:[Object(f.jsx)("input",Object(o.a)({type:"text",placeholder:"Photo Name",autoComplete:"off"},k("name",{required:{value:!0,message:"Please enter a photo name"}}))),Object(f.jsx)("p",{className:"message_error",children:null===(t=N.name)||void 0===t?void 0:t.message})]}),Object(f.jsxs)("div",{className:"special-container",children:[Object(f.jsx)(L,{register:k,setTags:g,tags:j}),Object(f.jsx)("p",{className:"message_error",children:j.length<1?null===(n=N.tags)||void 0===n?void 0:n.message:""})]}),Object(f.jsxs)("div",{className:"controller-textarea-container",children:[Object(f.jsx)("textarea",Object(o.a)({placeholder:"Photo Name",autoComplete:"off"},k("description",{required:{value:!0,message:"Please enter a description"}}))),Object(f.jsx)("p",{className:"message_error",children:null===(r=N.description)||void 0===r?void 0:r.message})]}),Object(f.jsx)("button",{className:"btn-upload-image",type:"button",onClick:w(D),children:"Upload"})]})]}),Object(f.jsx)(_.a,{progress:C,progressRef:F}),Object(f.jsx)(P.a,{message:"Photo upload",open:O})]})}}}]);
//# sourceMappingURL=7.4b636521.chunk.js.map